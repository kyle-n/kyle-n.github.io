<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="../img/favicon.png" />
    <meta name="viewport" content="width=device-width" />
    
		<link href="../_app/immutable/assets/0.c9dc93fe.css" rel="stylesheet">
		<link href="../_app/immutable/assets/5.bb950bb0.css" rel="stylesheet">
		<link href="../_app/immutable/assets/post-date.e48032c5.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.9023fadb.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/scheduler.63274e7e.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/singletons.c8a3f3e0.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.a45c3d45.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/preload-helper.a4192956.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index.9f372ec1.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.54178ba0.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/5.9a4ae76b.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/post-date.5bc99a03.js">
    <link
      rel="stylesheet"
      href="https://unpkg.com/sakura.css/css/sakura.css"
      media="screen"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/sakura.css/css/sakura-vader.css"
      media="screen and (prefers-color-scheme: dark)"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-xonokai.min.css"
      integrity="sha512-WMvUL/ap3JTqQEo4CIbB0jR2ACx+Qxg78UdKIWzV31CrefYZGtxuSod8uJwWDyzeVpQ0vKnXA41vS4UEvlNkoQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
  </head>
  <body data-sveltekit-preload-data="hover">
    <div style="display: contents">  <header data-svelte-h="svelte-jaj4c8"><h1>Kyle Nazario</h1> <nav class="svelte-60lm3e"><a href="/" class="svelte-60lm3e">Home</a> <a href="/about" class="svelte-60lm3e">About</a> <a href="/blog" class="svelte-60lm3e">Blog</a> <a href="/contact" class="svelte-60lm3e">Contact</a></nav> </header> <article><div id="title-and-date" class="svelte-1gdvj1q"><h2 class="svelte-1gdvj1q">You should unit test component templates</h2> <div class="svelte-1m8gdcp">May 4, 2023</div></div>  <div><p data-svelte-h="svelte-18nqa1t">There is a common misconception among frontend developers that you should not unit test the template of a component. This is incorrect. Not only <em>can</em> you test your components’ templates, but you <em>should</em>.</p> <h2 data-svelte-h="svelte-3q8ffy">Reason #1: It’s officially recommended</h2> <p data-svelte-h="svelte-m1myqy">The <a href="https://angular.io/guide/testing-components-basics" title="https://angular.io/guide/testing-components-basics" rel="nofollow">official Angular documentation</a> says (emphasis mine):</p> <blockquote data-svelte-h="svelte-40d2cq"><p>A component is more than just its class. A component interacts with the DOM and with other components. The class-only tests can tell you about class behavior. They cannot tell you if the component is going to render properly, respond to user input and gestures, or integrate with its parent and child components…</p> <p>A component, unlike all other parts of an Angular application, combines an HTML template and a TypeScript class. <strong>The component truly is the template and the class working together. To adequately test a component, you should test that they work together as intended.</strong></p></blockquote> <p data-svelte-h="svelte-qsqt7s">The docs writers are arguing components, unlike other parts of an Angular application, are code <em>and</em> markup, so both should be tested.</p> <h2 data-svelte-h="svelte-uu95qc">Reason #2: Tests should mimic real users</h2> <p data-svelte-h="svelte-x413w3">The whole reason to write automated tests is to give yourself <em>confidence</em> when shipping code. If you merge in a new feature and all the automated tests pass, you can be more confident your change has not caused a regression somewhere. You can’t be 100% confident, because no test suite is perfect, but good tests lower the odds of regressions.</p> <p data-svelte-h="svelte-55r5ub">What kind of test should make you feel more confident? I would argue it is a test which mimics real user behavior as closely as possible.</p> <p data-svelte-h="svelte-12f487e">Now, consider this: <strong>no user ever calls a method on your component’s class</strong>. If your component looks like this…</p> <pre class="language-typescript"><!-- HTML_TAG_START --><code class="language-typescript"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Component</span></span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  selector<span class="token operator">:</span> <span class="token string">'app-submit-button'</span><span class="token punctuation">,</span>
  template<span class="token operator">:</span> <span class="token string">'&lt;button (click)="onSubmit()">Submit&lt;/button>'</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">SubmitButtonComponent</span> <span class="token punctuation">&#123;</span>
  <span class="token function">onSubmit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'submitted'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-xdmtd5">…the user will never call <code>onSubmit()</code>. They will click the button element, and <em>that</em> will activate your component’s class functionality.</p> <p data-svelte-h="svelte-1n2p18b">If we wanted to test this component and mimic real user behavior, we should not directly call <code>onSubmit()</code> in our tests. We should simulate a click event on the <code>&lt;button&gt;</code> and then see if our component console logs. That way, we are testing whether the template and class work together as intended, just like the Angular documentation recommends.</p> <p data-svelte-h="svelte-1gkt3g9">Testing like this helps catch when the template and class are out of sync. For example, imagine we were in a rush and accidentally wrote:</p> <pre class="language-typescript"><!-- HTML_TAG_START --><code class="language-typescript"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Component</span></span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  selector<span class="token operator">:</span> <span class="token string">'app-submit-button'</span><span class="token punctuation">,</span>
  template<span class="token operator">:</span> <span class="token string">'&lt;button>Submit&lt;/button>'</span> <span class="token comment">// Forgot the click listener</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">SubmitButtonComponent</span> <span class="token punctuation">&#123;</span>
  <span class="token function">onSubmit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'submitted'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-1j57g26">This component is broken. Clicking the button in it doesn’t do anything. However, this mistake would not be caught by a unit test that directly called <code>onSubmit()</code>. By simulating a click on the <code>&lt;button&gt;</code> in our test instead, we mimic real user behavior and catch the error. For more, see <a href="https://kentcdodds.com/blog/why-i-never-use-shallow-rendering#without-shallow-rendering" rel="nofollow">Kent C. Dodds’ great post on shallow rendering</a>.</p> <blockquote data-svelte-h="svelte-e22kux"><p>The more your tests resemble the way your software is used, the more confidence they can give you.</p></blockquote> <h2 data-svelte-h="svelte-1kbmjy3">Reason #3: Test your component’s public API (the template)</h2> <p data-svelte-h="svelte-qeget3">It is generally a good idea to test modules of code through their public API.</p> <p data-svelte-h="svelte-ev1yye">For example, imagine you are writing accounting software and need a function called <code>isInvoiceInvalid()</code>. This function accepts one argument, <code>invoice</code>, and returns a boolean. The “public API” of this function is to just call it and see what it returns. We should test it through its public API by calling it with lots of different invoices and seeing if it correctly identifies which ones are invalid.</p> <p data-svelte-h="svelte-1e66r48"><code>isInvoiceInvalid()</code> may be using many private methods to judge whether an invoice is invalid, but you, the person writing the test, do not need to know what those methods are. You are simply testing the function through its public API and seeing if it returns the right result. If another developer comes along and rewrites <code>isInvoiceInvalid()</code>, your tests should keep running, because they don’t care about the implementation of the function. They just care that it works.</p> <p data-svelte-h="svelte-1wdfqbm">For Angular components, the template is the “public API” our users will use. They will tap, click and type into our templates to cause changes in our application. Testing through the template gives us some distance between our tests and the actual implementation of our component. Hopefully we can change the implementation of our component class without breaking our tests.</p> <p data-svelte-h="svelte-ez8y9t">For example, here is a <a href="https://github.com/kyle-n/template-demo" title="https://github.com/kyle-n/template-demo" rel="nofollow">sample Angular project</a> (<a href="https://stackblitz.com/edit/angular-rks7bk?file=src/app/app.component.ts" title="https://stackblitz.com/edit/angular-rks7bk?file=src/app/app.component.ts" rel="nofollow">StackBlitz</a>) with a basic signup form. The user can type in a username and password. As they type in the password field, they see up to three colored boxes rating the strength of their chosen password. For a password that meets all the requirements, they will see three green boxes.</p> <p data-svelte-h="svelte-efy2zg"><img src="/img/template-demo.png" alt="A screenshot of my 'Template Demo' app with a signup form and password strength component. It is displaying three green boxes to show maximum password strength."></p> <p data-svelte-h="svelte-1dd5vv8">The green boxes are a <a href="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0" title="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0" rel="nofollow">presenter component</a> that accepts the user’s password strength as an input and <a href="https://github.com/kyle-n/template-demo/tree/main/src/app/password-strength-indicator" title="https://github.com/kyle-n/template-demo/tree/main/src/app/password-strength-indicator" rel="nofollow">renders it as up to three colored boxes</a>.</p> <pre class="language-typescript"><!-- HTML_TAG_START --><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> Component<span class="token punctuation">,</span> Input <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> PasswordStrength <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'../models/password-strength.type'</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Component</span></span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  selector<span class="token operator">:</span> <span class="token string">'app-password-strength-indicator'</span><span class="token punctuation">,</span>
  templateUrl<span class="token operator">:</span> <span class="token string">'./password-strength-indicator.component.html'</span><span class="token punctuation">,</span>
  styleUrls<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./password-strength-indicator.component.css'</span><span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">PasswordStrengthIndicatorComponent</span> <span class="token punctuation">&#123;</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Input</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> passwordStrength<span class="token operator">:</span> PasswordStrength <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token keyword">get</span> <span class="token function">strengthColorCssClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>passwordStrength<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token string">'red'</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token string">'red'</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token string">'yellow'</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token string">'green'</span><span class="token punctuation">;</span>
      <span class="token keyword">default</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token comment">// Please excuse this hacky ngFor workaround</span>
  <span class="token keyword">get</span> <span class="token function">arrayForNgFor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> numberOfBoxes <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>passwordStrength <span class="token operator">??</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Array</span></span><span class="token punctuation">(</span>numberOfBoxes<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <pre class="language-html"><!-- HTML_TAG_START --><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
    <span class="token attr-name">*ngFor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>let i of arrayForNgFor<span class="token punctuation">"</span></span>
    <span class="token attr-name">[ngClass]</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>strengthColorCssClass<span class="token punctuation">"</span></span>
    <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>strength-box<span class="token punctuation">"</span></span>
  <span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code><!-- HTML_TAG_END --></pre> <pre class="language-css"><!-- HTML_TAG_START --><code class="language-css"><span class="token selector">.container</span> <span class="token punctuation">&#123;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> start<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token selector">.strength-box</span> <span class="token punctuation">&#123;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> 1px solid black<span class="token punctuation">;</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.red</span> <span class="token punctuation">&#123;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.yellow</span> <span class="token punctuation">&#123;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> yellow<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.green</span> <span class="token punctuation">&#123;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-1i94vhd"><code>PasswordStrengthIndicatorComponent</code> is almost akin to a <a href="https://en.wikipedia.org/wiki/Pure_function" title="https://en.wikipedia.org/wiki/Pure_function" rel="nofollow">pure function</a>. It accepts one input, <code>passwordStrength</code>, and displays that many boxes to the user in the template.</p> <p data-svelte-h="svelte-1174o66">The “public API” of this component is its template. It’s the number and color of the boxes displayed to the user. We <em>must</em> test the template to see if it works.</p> <h2 data-svelte-h="svelte-1ftgwlz">How to test Angular components through the template</h2> <p data-svelte-h="svelte-1x9xv8o"><code>PasswordStrengthIndicatorComponent</code> is a useful example to demonstrate how to unit test a component through its template. We want to see if it will render one box for each point of the user’s password strength. To test that, we should start with the test file created when we ran <code>ng generate component</code>:</p> <pre class="language-typescript"><!-- HTML_TAG_START --><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> ComponentFixture<span class="token punctuation">,</span> TestBed <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'@angular/core/testing'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> PasswordStrengthIndicatorComponent <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'./password-strength-indicator.component'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> By <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'@angular/platform-browser'</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'PasswordStrengthIndicatorComponent'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">let</span> component<span class="token operator">:</span> PasswordStrengthIndicatorComponent<span class="token punctuation">;</span>
  <span class="token keyword">let</span> fixture<span class="token operator">:</span> ComponentFixture<span class="token operator">&lt;</span>PasswordStrengthIndicatorComponent<span class="token operator">></span><span class="token punctuation">;</span>

  <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">await</span> TestBed<span class="token punctuation">.</span><span class="token function">configureTestingModule</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
      declarations<span class="token operator">:</span> <span class="token punctuation">[</span>PasswordStrengthIndicatorComponent<span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">compileComponents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    fixture <span class="token operator">=</span> TestBed<span class="token punctuation">.</span><span class="token function">createComponent</span><span class="token punctuation">(</span>PasswordStrengthIndicatorComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
    component <span class="token operator">=</span> fixture<span class="token punctuation">.</span>componentInstance<span class="token punctuation">;</span>
    fixture<span class="token punctuation">.</span><span class="token function">detectChanges</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-2imkvi">This code creates a virtual DOM and mounts <code>PasswordStrengthIndicatorComponent</code> within it.</p> <p data-svelte-h="svelte-115p6r3">Some Angular developers are strongly anti-<code>TestBed</code>, on the grounds that it is clunky and slow. I sympathize with this view. It is undeniably painful to do dependency injection with <code>TestBed</code>. However, it is still the best way to test <em>all</em> of your component, template included. It is also <a href="https://github.com/angular/angular/issues/12409#issuecomment-599223073" title="https://github.com/angular/angular/issues/12409#issuecomment-599223073" rel="nofollow">much faster</a> in Angular 9+.</p> <p data-svelte-h="svelte-1dtk8wm">Second, let’s write two helper functions we can use across our tests:</p> <pre class="language-typescript"><!-- HTML_TAG_START --><code class="language-typescript"><span class="token comment">// ...</span>
<span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  fixture <span class="token operator">=</span> TestBed<span class="token punctuation">.</span><span class="token function">createComponent</span><span class="token punctuation">(</span>PasswordStrengthIndicatorComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
  component <span class="token operator">=</span> fixture<span class="token punctuation">.</span>componentInstance<span class="token punctuation">;</span>
  fixture<span class="token punctuation">.</span><span class="token function">detectChanges</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">numberOfStrengthBoxes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> fixture<span class="token punctuation">.</span>debugElement<span class="token punctuation">.</span><span class="token function">queryAll</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'div.strength-box'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">strengthBoxIsColored</span><span class="token punctuation">(</span>color<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> strengthBox <span class="token operator">=</span> fixture<span class="token punctuation">.</span>debugElement<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'div.strength-box'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>nativeElement <span class="token keyword">as</span> HTMLDivElement<span class="token punctuation">;</span>
  <span class="token keyword">return</span> strengthBox<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">// ...</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-15c0bsr">These two functions analyze the template of our test environment to check our “public API” is returning the correct results. We should try to avoid tying our tests too closely to the specific HTML layout of our component, so let’s just count the number of boxes and their color.</p> <p data-svelte-h="svelte-j6zy0n">Last, let’s test the component behaves as expected:</p> <pre class="language-typescript"><!-- HTML_TAG_START --><code class="language-typescript"><span class="token comment">// ...</span>
<span class="token keyword">function</span> <span class="token function">strengthBoxIsColored</span><span class="token punctuation">(</span>color<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> strengthBox <span class="token operator">=</span> fixture<span class="token punctuation">.</span>debugElement<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'div.strength-box'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>nativeElement <span class="token keyword">as</span> HTMLDivElement<span class="token punctuation">;</span>
  <span class="token keyword">return</span> strengthBox<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should render one strength box for each point of password strength'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  component<span class="token punctuation">.</span>passwordStrength <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
  fixture<span class="token punctuation">.</span><span class="token function">detectChanges</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">numberOfStrengthBoxes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should color the strength boxes red if password strength is 1'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  component<span class="token punctuation">.</span>passwordStrength <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  fixture<span class="token punctuation">.</span><span class="token function">detectChanges</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">strengthBoxIsColored</span><span class="token punctuation">(</span><span class="token string">'red'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeTrue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should color the strength boxes yellow if password strength is 2'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  component<span class="token punctuation">.</span>passwordStrength <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
  fixture<span class="token punctuation">.</span><span class="token function">detectChanges</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">strengthBoxIsColored</span><span class="token punctuation">(</span><span class="token string">'yellow'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeTrue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should color the strength boxes green if password strength is 3'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  component<span class="token punctuation">.</span>passwordStrength <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
  fixture<span class="token punctuation">.</span><span class="token function">detectChanges</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">strengthBoxIsColored</span><span class="token punctuation">(</span><span class="token string">'green'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeTrue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-90a6wk">See? Not so bad.</p> <p data-svelte-h="svelte-qirtv3">This test could have gone further and even used <a href="https://circleci.com/blog/snapshot-testing-with-jest/" title="https://circleci.com/blog/snapshot-testing-with-jest/" rel="nofollow">snapshot testing</a> to verify that the <code>green</code> CSS class actually made the box green, but snapshot tests tend to be brittle. Again, we don’t want to tie our tests too tightly to the current implementation of the component. Checking for the right CSS class should be enough.</p> <h2 data-svelte-h="svelte-grw4hp">Conclusion</h2> <p data-svelte-h="svelte-1ff5idl">Components are the combination of logic and markup. To make sure they work for your users, you should test both of them, and that they work together correctly.</p></div> </article> <hr class="svelte-y12ktw"> <footer><p>© 2023 Kyle Nazario</p> </footer> 
			
			<script>
				{
					__sveltekit_pm65wa = {
						base: new URL("..", location).pathname.slice(0, -1),
						env: {}
					};

					const element = document.currentScript.parentElement;

					const data = [null,null];

					Promise.all([
						import("../_app/immutable/entry/start.9023fadb.js"),
						import("../_app/immutable/entry/app.a45c3d45.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 5],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
  </body>
</html>
